 04-27 at 00:34 | backbone: resnet10
model_name: CropDisease_426
model_args: null
linear_bn: false
linear_bn_affine: false
suffix: ''
source_data: miniImageNet
disable_validation: false
seed: 0
ckpt: null
load_base: true
load_flexible: true
resume: false
pretrained: false
data:
  disable_validation: false
  dataset: miniImageNet_train
  val_dataset: CropDisease_test
  test_dataset: null
  image_size: 224
  batch_size: 32
  val_batch_size: null
  num_classes: null
  split_fraction: 0.2
  normalize_type: imagenet
  train_aug: true
  val_aug: few_shot_test
  train_split_type: null
  val_split_type: null
  seed: 0
  split_seed: 0
  num_workers: 6
  shuffle_val: false
  limit_train_data: null
  replica_rank: null
  num_replica: 1
  n_way: 5
  n_shot: 5
  n_query: 15
  num_episodes: 600
trainer:
  logger: false
  checkpoint_callback: true
  default_root_dir: null
  num_nodes: 1
  tpu_cores: null
  check_val_every_n_epoch: 5
  fast_dev_run: false
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  accelerator: ddp
  sync_batchnorm: true
  num_sanity_val_steps: 0
  resume_from_checkpoint: null
  benchmark: false
  reload_dataloaders_every_epoch: false
  terminate_on_nan: false
  auto_scale_batch_size: false
  automatic_optimization: null
  progress_bar_refresh_rate: 0
  log_every_n_steps: 10000000000
  replace_sampler_ddp: false
  weights_save_path: ckpt/CropDisease_426
  max_epochs: 120
  gpus: 3
  deterministic: true
disable_logfile: false
logger:
  _target_: utils.custom_logger.CustomLogger
  name: CropDisease_426
  version: null
  test: false
  save_dir: logs
  disable_logfile: false
optimizer:
  _target_: torch.optim.SGD
  lr: 0.0005
  momentum: 0.9
  dampening: 0
  weight_decay: 0.0001
  nesterov: false
eval_mode: few_shot
n_way: 5
n_shot: 5
n_query: 15
print_val: false
eval:
  fine_tune:
    name: LR
    use_norm: false
callbacks:
  model_checkpoint:
    _target_: callbacks.custom_callbacks.CheckpointCallback
    monitor: acc_mean
    save_top_k: 1
    save_last: true
    mode: max
    filename: '{epoch:03d}'
    dirpath: ckpt/CropDisease_426
    verbose: true
    save_every_n_epoch: null
  lr_logger:
    _target_: callbacks.lr_monitor.LearningRateMonitor
    logging_interval: epoch
scheduler:
  _target_: torch.optim.lr_scheduler.MultiStepLR
  milestones:
  - 84
  - 108
  gamma: 0.1
test: false
lm_ce: 1
lm_u: 1
cosine_weight: true
teacher_temp: 0.1
apply_unlabel: true
reset_student_head: false
unlabel_aug: weak_strong
simclr: false
simclr_params:
  temperature: 0.1
  projection: true
unlabel_params:
  dataset: CropDisease_train
  batch_size: 32
  unlabel_aug: weak_strong
  no_stop_grad: false
ckpt_preload: ./ckpt/best.ckpt
launcher:
  time: '6'
  name: local
  gpus: 3
system_name: ce_distill_ema
mometum_update: 0.99
apply_center: false
center_momentum: 0.9
extractor: student

 04-27 at 00:34 | loading indices from data/cache_cdfsl/CropDisease_indices_partial_train_0.2_0.npy
 04-27 at 00:34 | None
 04-27 at 00:34 | []
 04-27 at 00:34 | loaded dataset CropDisease_train:: #data: 10849
 04-27 at 00:34 | unlabel batch: 339
 04-27 at 00:34 | unlabel loader size: 113
 04-27 at 00:34 | loaded dataset miniImageNet_train:: #data: 38400
 04-27 at 00:34 | train loader size: 400
 04-27 at 00:34 | loading indices from data/cache_cdfsl/CropDisease_indices_partial_test_0.2_0.npy
 04-27 at 00:34 | loading indices from data/cache_cdfsl/CropDiseasetest_fs_indices__partial_0.2_0.npy
 04-27 at 00:34 | loaded dataset CropDisease_test:: #class: 38, #data: 43456
